---
title: "Datafest-CA"
author: "Ting Wang"
date: '2021-04-28'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dbplyr)
library(tidyverse)
library(readxl)
library(lme4)
```

```{r,message=FALSE}
dataca <- read_csv("./Data Cleaning/CA_Clean.csv")
attach(dataca)
head(dataca)
```


```{r}
dataca$FENT_NMU[is.na(dataca$FENT_NMU)] <- 0
dataca$BUP_NMU[is.na(dataca$BUP_NMU)] <- 0
dataca$METH_NMU[is.na(dataca$METH_NMU)] <- 0
dataca$MORPH_NMU[is.na(dataca$MORPH_NMU)] <- 0
dataca$OXY_NMU[is.na(dataca$OXY_NMU)] <- 0
dataca$OXYM_NMU[is.na(dataca$OXYM_NMU)] <- 0
dataca$TRAM_NMU[is.na(dataca$TRAM_NMU)] <- 0
dataca$TAP_NMU[is.na(dataca$TAP_NMU)] <- 0
dataca$COD_NMU[is.na(dataca$COD_NMU)] <- 0
dataca$COTC_NMU[is.na(dataca$COTC_NMU)] <- 0
dataca$HYD_NMU[is.na(dataca$HYD_NMU)] <- 0
dataca$HYDM_NMU[is.na(dataca$HYDM_NMU)] <- 0
dataca$SUF_NMU[is.na(dataca$SUF_NMU)] <- 0
dataca$STIM_NMU[is.na(dataca$STIM_NMU)] <- 0
dataca$BENZ_NMU[is.na(dataca$BENZ_NMU)] <- 0
dataca$THC_NMU[is.na(dataca$THC_NMU)] <- 0

dataca <- dataca %>%
  mutate(total_misuse =FENT_NMU + BUP_NMU + METH_NMU + MORPH_NMU + OXY_NMU + OXYM_NMU + TRAM_NMU + TAP_NMU + COD_NMU + COTC_NMU + HYD_NMU + HYDM_NMU + SUF_NMU + STIM_NMU +  BENZ_NMU + THC_NMU)
hist(dataca$total_misuse)
boxplot(dataca$total_misuse)
summary(dataca$total_misuse)
```

```{r}
abor <- as.factor(DEM_ABOR)
location <- as.factor(DEM_LOCATION)
marital <- as.factor(DEM_MARITAL)
income <- as.factor(DEM_INCOME)
edu <- as.factor(DEM_EDU)


model <- glm(total_misuse ~ DEM_AGE10 + abor + location + marital + income + edu, family=poisson, data = dataca)
summary(model)
#sig var include age, abor, location (all besides NB, Nunavut and Northwest), marital (common law and seperated), income (160,000 or more and refer not to say), edu (trade and uni below bachelor)

#higher age, less misuse 
#being abor, more misuse 
#locations are sig, baseline is New found land and labrador 
#married is the lowest misuse, other types increase misuse 
#higher income, less misuse 
#higher edu, generally less misuse, most misuse for University certificate or diploma below the bachelor's level
```
```{r}
alcohol <- as.factor(ALC_FREQ_USE)
cig <- as.factor(TOB_FREQ_USE)
other_drug <- as.factor(OTH_RX_DRUG_USE)

model2 <- glm(total_misuse ~ alcohol + cig + other_drug, family=poisson, data = dataca)
summary(model2)
#all significant
```








