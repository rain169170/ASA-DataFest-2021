plot_misuse<- ggplot(data=prop_misuse, aes(x=drugs, y=prop)) +
geom_bar(stat="identity", width=0.5) +
labs(title="Proportion of Misuse by Drug Type in United States 2018",
x ="Drug Type", y = "Proportion of Misuse") + theme_classic() + scale_color_manual(values=c("chocolate2"))+
scale_fill_manual(values=c("steelblue"))
plot_misuse
ggsave("Proportion of misuse by drug type in US18.png", plot_misuse)
dataca_totalmisuse%>%
select(total_misuse,DEM_GENDER)%>%
tbl_summary(by=DEM_GENDER)%>%
modify_header(label ~ "**Variable**")
dataca_totalmisuse%>%
select(total_misuse,DEM_GENDER)%>%
tbl_summary(by=DEM_GENDER)%>%
modify_header(label ~ "**Variable**")
dataca_totalmisuse
dataca_totalmisuse$total_misuse
dataca_totalmisuse$total_misuse
dataca_totalmisuse%>%
select(total_misuse,DEM_GENDER)%>%
tbl_summary(by=DEM_GENDER)%>%
modify_header(label ~ "**Variable**")
dataca_totalmisuse$total_misuse
dataca_totalmisuse%>%
select(as.factor(total_misuse),DEM_GENDER)%>%
tbl_summary(by=DEM_GENDER)%>%
modify_header(label ~ "**Variable**")
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, fill = ..x..)) +
geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +
scale_fill_viridis(name = "Temp. [F]", option = "C") +
labs(title = 'Temperatures in Lincoln NE in 2016') +
theme_ipsum() +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
strip.text.x = element_text(size = 8)
)
install.packages("ggridges")
library(ggridges)
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, fill = ..x..)) +
geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +
scale_fill_viridis(name = "Temp. [F]", option = "C") +
labs(title = 'Temperatures in Lincoln NE in 2016') +
theme_ipsum() +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
strip.text.x = element_text(size = 8)
)
install.packages("hrbrthemes")
library(hrbrthemes)
install.packages("hrbrthemes")
library(hrbrthemes)
knitr::opts_chunk$set(echo = TRUE)
library(dbplyr)
library(tidyverse)
library(readxl)
library(cowplot)
library(viridis)
library(gtsummary)
library(plotly)
library(gplots)
library(RColorBrewer)
library(heatmaply)
library(ggthemes)
library(ggridges)
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, fill = ..x..)) +
geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +
scale_fill_viridis(name = "Temp. [F]", option = "C") +
labs(title = 'Temperatures in Lincoln NE in 2016') +
theme_classic() +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
strip.text.x = element_text(size = 8)
)
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, y = count, fill = ..x..)) +
geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +
scale_fill_viridis(name = "Temp. [F]", option = "C") +
labs(title = 'Temperatures in Lincoln NE in 2016') +
theme_classic() +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
strip.text.x = element_text(size = 8)
)
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, fill = ..x..)) +
geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +
scale_fill_viridis(name = "Temp. [F]", option = "C") +
labs(title = 'Temperatures in Lincoln NE in 2016') +
theme_classic() +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
strip.text.x = element_text(size = 8)
)
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, y = DEM_AGE10,fill = ..x..)) +
geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +
scale_fill_viridis(name = "Temp. [F]", option = "C") +
labs(title = 'Temperatures in Lincoln NE in 2016') +
theme_classic() +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
strip.text.x = element_text(size = 8)
)
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, y = DEM_AGE10,fill = ..x..)) +
geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +
scale_fill_viridis(name = "Temp. [F]", option = "C") +
labs(title = 'Temperatures in Lincoln NE in 2016') +
theme_classic() +
theme(
legend.position="none",
panel.spacing = unit(0.1, "lines"),
strip.text.x = element_text(size = 8)
)
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, fill = DEM_GENDER), alpha = 0.4) +
scale_fill_manual(values = c("#00AFBB", "#E7B800")) + scale_color_manual(values = c("#00AFBB", "#E7B800"))
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, fill = DEM_GENDER)) + geom_histogram(aes(color = sex, fill = sex), alpha =0.4, position = "identity", bins = 50) + scale_fill_manual(values = c("#00AFBB", "#E7B800")) + scale_color_manual(values = c("#00AFBB", "#E7B800"))
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, fill = DEM_GENDER)) + geom_histogram(aes(color = DEM_GENDER, fill = DEM_GENDER), alpha =0.4, position = "identity", bins = 50) + scale_fill_manual(values = c("#00AFBB", "#E7B800")) + scale_color_manual(values = c("#00AFBB", "#E7B800"))
dataca_totalmisuse %>% ggplot(aes(x = total_misuse)) + geom_histogram(aes(color = DEM_GENDER, fill = DEM_GENDER), alpha =0.4, position = "identity", bins = 50) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
dataca_totalmisuse %>% ggplot(aes(x = total_misuse)) + geom_histogram(aes(color = DEM_GENDER), alpha =0.4, position = "identity", bins = 50) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
dataca_totalmisuse %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity") + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
dataca_totalmisuse %>% ggplot(aes(x = total_misuse, fill = DEM_GENDER)) + geom_histogram(aes(color = DEM_GENDER, fill = DEM_GENDER), alpha =0.4, position = "identity", bins = 50) + scale_fill_manual(values = c("#00AFBB", "#E7B800")) + scale_color_manual(values = c("#00AFBB", "#E7B800"))
dataca_totalmisuse %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity") + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity") + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
dataca_totalmisuse %>% filter(DEM_GENDER == "Male") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity") + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
totgender <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity") + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
plotly(totgender)
ggplotly(totgender)
totgender <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity") + geom_smooth()+ scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
ggplotly(totgender)
totgender <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity") + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
ggplotly(totgender)
totgender <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", breaks=seq(20, 50, by=2)) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
ggplotly(totgender)
totgender <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", binwidth = 2) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
ggplotly(totgender)
totgender <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", binwidth = 1) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
ggplotly(totgender)
totgenderf <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", binwidth = 1) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
totgenderf <- ggplotly(totgenderf)
dataca_totalmisuse %>% filter(DEM_GENDER == "Male") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", binwidth = 1) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
totgenderm <- ggplotly(totgenderm)
totgenderf <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", binwidth = 1) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
totgenderf <- ggplotly(totgenderf)
totgenderm <-dataca_totalmisuse %>% filter(DEM_GENDER == "Male") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", binwidth = 1) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
totgenderm <- ggplotly(totgenderm)
totgender <- plot_grid(totgenderf, totgenderm)
totgenderf <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", binwidth = 1) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
#totgenderf <- ggplotly(totgenderf)
totgenderm <-dataca_totalmisuse %>% filter(DEM_GENDER == "Male") %>% ggplot(aes(x = total_misuse)) + geom_histogram(alpha =0.4, position = "identity", binwidth = 1) + scale_fill_manual(values = "chocolate2") + scale_color_manual(values ="chocolate2")
#totgenderm <- ggplotly(totgenderm)
totgender <- plot_grid(totgenderf, totgenderm)
totgender
dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) +
geom_freqpoly(binwidth = 500)
dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) +
geom_freqpoly(binwidth = 1)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) +
geom_freqpoly(binwidth = 1)
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) +
geom_freqpoly(binwidth = 1)  + scale_fill_manual(values = "chocolate2")
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) +
geom_freqpoly(binwidth = 1) + theme_classic()
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) +
geom_freqpoly(binwidth = 1) + theme_wallstreet()
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) +
geom_freqpoly(binwidth = 1) + theme_economist()
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) +
geom_freqpoly(binwidth = 1) + theme_economist_white()
ggplotly(totgender)
htmlwidgets::saveWidget(1, "index.html")
1 <- ggplotly(totgender)
l <- ggplotly(totgender)
htmlwidgets::saveWidget(l, "index.html")
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+
geom_freqpoly(binwidth = 1) + theme_economist_white()
l <- ggplotly(totgender)
htmlwidgets::saveWidget(l, "index.html")
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+
geom_freqpoly(binwidth = 1)
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+ theme_clean() +
geom_freqpoly(binwidth = 1)
l <- ggplotly(totgender)
l
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+ theme_classic() +
geom_freqpoly(binwidth = 1)
l <- ggplotly(totgender)
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+ theme_excel() +
geom_freqpoly(binwidth = 1)
l <- ggplotly(totgender)
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+ theme_excel_new() +
geom_freqpoly(binwidth = 1)
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+ theme_excel_new() + xlab("hi")
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+ theme_excel_new() + xlab("hi")+
geom_freqpoly(binwidth = 1)
ggplotly(totgender)
totgender<- dataca_totalmisuse %>% ggplot(aes(total_misuse,colour = DEM_GENDER)) + xlim(c(0, 16))+ theme_minimal_hgrid() +
geom_freqpoly(binwidth = 1)
ggplotly(totgender)
ggplotly(totgender)
ggplotly(totgender)
l <- ggplotly(totgender)
htmlwidgets::saveWidget(l, "index.html")
prov <- heatmaply(mat_data,
xlab = "Drugs",
ylab = "Provinces",
main = "Drug misuse rates for each province by type of drugs",
scale_fill_gradient_fun = ggplot2::scale_fill_gradient2(
low = "steelblue",
high = "chocolate2",
midpoint = 0.5,
limits = c(0, 1)
))
htmlwidgets::saveWidget(prov, "province.html")
mari <- heatmaply(mat_data_marital,
xlab = "Drugs",
ylab = "Marital Status",
main = "Drug misuse rates for each age by type of drugs",
scale_fill_gradient_fun = ggplot2::scale_fill_gradient2(
low = "steelblue",
high = "chocolate2",
midpoint = 0.5,
limits = c(0, 1)
))
mari <- heatmaply(mat_data_marital,
xlab = "Drugs",
ylab = "Marital Status",
main = "Drug misuse rates for each age by type of drugs",
scale_fill_gradient_fun = ggplot2::scale_fill_gradient2(
low = "steelblue",
high = "chocolate2",
midpoint = 0.5,
limits = c(0, 1)
))
htmlwidgets::saveWidget(mari, "marital.html")
prov <- heatmaply(mat_data,
xlab = "Drugs",
ylab = "Provinces",
main = "Proportion of Misuse by Drug Type in Canada by Province",
scale_fill_gradient_fun = ggplot2::scale_fill_gradient2(
low = "steelblue",
high = "chocolate2",
midpoint = 0.5,
limits = c(0, 1)
))
prov <- heatmaply(mat_data,
xlab = "Drugs",
ylab = "Provinces",
main = "Proportion of Misuse by Drug Type in Canada by Province",
scale_fill_gradient_fun = ggplot2::scale_fill_gradient2(
low = "steelblue",
high = "chocolate2",
midpoint = 0.5,
limits = c(0, 1)
))
htmlwidgets::saveWidget(prov, "province.html")
library(tidyverse)
#Import Data
dataca <- read_csv("../Source Data/CA-Data/ca.csv")
datade <- read_csv("../Source Data/DE-Data/de.csv")
datauk <- read_csv("../Source Data/UK-Data/uk.csv")
dataus18 <- read_csv("../Source Data/US-Data/us_18Q1.csv")
dataus19 <- read_csv("../Source Data/US-Data/nmurx_us_19Q1.csv")
dataca_totalmisuse$total_misuse
table(dataca$DEM_GENDER)
# Label gender based on the given number in the source data
dataca$DEM_GENDER[dataca$DEM_GENDER == 1] <- "Male"
dataca$DEM_GENDER[dataca$DEM_GENDER == 2] <- "Female"
# Label location based on the survey
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 1] <- "NL"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 2] <- "NS"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 3] <- "PE"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 4] <- "NB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 5] <- "QC"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 6] <- "ON"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 7] <- "MB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 8] <- "SK"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 9] <- "AB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 10] <- "BC"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 11] <- "YT"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 12] <- "NU"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 13] <- "NT"
# Label region based on the survey
dataca$DEM_REGION[dataca$DEM_REGION == 1] <- "Altantic"
dataca$DEM_REGION[dataca$DEM_REGION == 2] <- "Quebec"
dataca$DEM_REGION[dataca$DEM_REGION == 3] <- "Ontario"
dataca$DEM_REGION[dataca$DEM_REGION == 4] <- "West"
# Label income based on the survey
dataca$DEM_INCOME[dataca$DEM_INCOME == 1] <- "<20,000"
dataca$DEM_INCOME[dataca$DEM_INCOME == 2] <- "20,000-39,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 3] <- "40,000-59,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 4] <- "60,000-79,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 5] <- "80,000-99,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 6] <- "100,000-119,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 7] <- "120,000-139,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 8] <- "140,000-159,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 9] <- ">160,000"
dataca$DEM_INCOME[dataca$DEM_INCOME == 10] <- "prefer not say"
# Label marital status based on the survey
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 1] <- "Married"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 2] <- "Living common-law"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 3] <- "Widowed"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 4] <- "Separated"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 5] <- "Divorced"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 6] <- "Never married"
# Label Pregnancy based on the survey
dataca$DEM_PREG[dataca$DEM_PREG == 1] <- "Pregnant"
dataca$DEM_PREG[dataca$DEM_PREG == 0] <- "Not pregnant"
# As.factor some variables
dataca$DEM_EDU <- as.factor(dataca$DEM_EDU)
#Export cleaned data
write.csv(dataca, "./CA_Clean.csv")
#write.csv(datade, "./DE_Clean.csv")
#write.csv(datauk, "./UK_Clean.csv")
#write.csv(dataus18, "./US18_Clean.csv")
#write.csv(dataus19, "./US19_Clean.csv")
# Calculate total number of misused drugs for all 16 drugs for each participant
# Stored in variable total_misuse
dataca$FENT_NMU[is.na(dataca$FENT_NMU)] <- 0
dataca$BUP_NMU[is.na(dataca$BUP_NMU)] <- 0
dataca$METH_NMU[is.na(dataca$METH_NMU)] <- 0
dataca$MORPH_NMU[is.na(dataca$MORPH_NMU)] <- 0
dataca$OXY_NMU[is.na(dataca$OXY_NMU)] <- 0
dataca$OXYM_NMU[is.na(dataca$OXYM_NMU)] <- 0
dataca$TRAM_NMU[is.na(dataca$TRAM_NMU)] <- 0
dataca$TAP_NMU[is.na(dataca$TAP_NMU)] <- 0
dataca$COD_NMU[is.na(dataca$COD_NMU)] <- 0
dataca$COTC_NMU[is.na(dataca$COTC_NMU)] <- 0
dataca$HYD_NMU[is.na(dataca$HYD_NMU)] <- 0
dataca$HYDM_NMU[is.na(dataca$HYDM_NMU)] <- 0
dataca$SUF_NMU[is.na(dataca$SUF_NMU)] <- 0
dataca$STIM_NMU[is.na(dataca$STIM_NMU)] <- 0
dataca$BENZ_NMU[is.na(dataca$BENZ_NMU)] <- 0
dataca$THC_NMU[is.na(dataca$THC_NMU)] <- 0
dataca1 <- dataca %>%
mutate(total_misuse =FENT_NMU + BUP_NMU + METH_NMU + MORPH_NMU + OXY_NMU + OXYM_NMU + TRAM_NMU + TAP_NMU + COD_NMU + COTC_NMU + HYD_NMU + HYDM_NMU + SUF_NMU + STIM_NMU +  BENZ_NMU + THC_NMU)
dataca1 <- dataca1 %>% mutate(has_misuse = ifelse(total_misuse >= 1, 1, 0))
dataca$has_misuse <- as.factor(dataca$has_misuse)
dataca1$has_misuse <- as.factor(dataca$has_misuse)
dataca1 <- dataca1 %>% mutate(has_misuse = ifelse(total_misuse >= 1, 1, 0))
dataca1$has_misuse <- as.factor(dataca1$has_misuse)
write.csv(dataca1, "./CA_total_misuse.csv")
knitr::opts_chunk$set(echo = TRUE)
library(dbplyr)
library(tidyverse)
library(readxl)
library(cowplot)
library(viridis)
library(gtsummary)
library(plotly)
library(gplots)
library(RColorBrewer)
library(heatmaply)
library(ggthemes)
library(ggridges)
dataca <- read_csv("../Data Cleaning/CA_Clean.csv")
datade <- read_csv("../Data Cleaning/DE_Clean.csv")
datauk <- read_csv("../Data Cleaning/UK_Clean.csv")
dataus18 <- read_csv("../Data Cleaning/US18_Clean.csv")
dataca_totalmisuse <- read_csv("../Data Cleaning/CA_total_misuse.csv")
attach(dataca)
dataca
dataca_totalmisuse
dataca_totalmisuse$has_misuse
dataca_totalmisuse$has_misuse
incomef <- dataca_totalmisuse %>% filter(DEM_GENDER == "Female") %>%
ggplot(aes(x=DEM_INCOME, y=has_misuse))+ ylim(0, 15) +
geom_count(color = "chocolate2")+scale_size_area(max_size = 8)+
ggtitle("Total Misuse by income for Female") + xlab("Income")+
theme_light()+ theme(axis.text.x = element_text(angle = 45, hjust = 1))
incomem <- dataca_totalmisuse %>% filter(DEM_GENDER == "Male") %>%
ggplot(aes(x=DEM_INCOME, y=has_misuse))+ ylim(0, 15) +
geom_count(color = "steelblue")+scale_size_area(max_size = 8)+
ggtitle("Total Misuse by income for Male") + xlab("Income")+
theme_light()+ theme(axis.text.x = element_text(angle = 45, hjust = 1))
incomegender <- plot_grid(incomef, incomem)
incomegender
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, fill=DEM_GENDER)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, fill=DEM_GENDER)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_classic() +
labs(fill="")
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, stat="count",fill=DEM_GENDER)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_classic() +
labs(fill="")
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, fill=DEM_GENDER)) +
geom_bar( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_classic() +
labs(fill="")
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, fill=DEM_GENDER)) +
geom_bar( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_classic() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, fill=DEM_GENDER)) +
geom_bar( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, fill=DEM_GENDER)) +
geom_bar( color="#e9ecef", alpha=0.6, position = 'identity') + geom_line(data = dataca_totalmisuse, aes(x= DEM_INCOME, y = has_misuse))
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, fill=DEM_GENDER)) +
geom_bar( color="#e9ecef", alpha=0.6, position = 'identity') + geom_line(data = dataca_totalmisuse, aes(x= DEM_INCOME, y = has_misuse))+
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
labs(fill="") +geom_line(data = dataca_totalmisuse, aes(x= DEM_INCOME, y = has_misuse))
dataca_totalmisuse %>%
ggplot(aes(x=DEM_INCOME, fill=DEM_GENDER)) +
geom_bar( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(fill="") +geom_line(data = dataca_totalmisuse, aes(x= DEM_INCOME, y = has_misuse))
dataca_totalmisuse %>%
ggplot() +
geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(fill="") +geom_line(data = dataca_totalmisuse, aes(x= DEM_INCOME, y = has_misuse))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  +geom_line(data = dataca_totalmisuse, aes(x= DEM_INCOME, y = has_misuse)) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="")
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  +geom_line(data = dataca_totalmisuse, aes(x= DEM_INCOME, y = has_misuse)) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "series2"))
dataca_totalmisuse %>%
ggplot()+geom_line(aes(x= DEM_INCOME, y = has_misuse))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  +geom_line(aes(x= DEM_INCOME, y = has_misuse)) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "series2"))
dataca_totalmisuse %>%
ggplot()+geom_line(aes(x= DEM_INCOME, y = has_misuse))
dataca_totalmisuse %>%
ggplot()+ geom_point(aes(x= DEM_INCOME, y = has_misuse))
dataca_totalmisuse %>% group_by(DEM_INCOME) %>% summarise(misuse = sum(has_misuse))
dat_misuse <- dataca_totalmisuse %>% group_by(DEM_INCOME) %>% summarise(misuse = sum(has_misuse))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  +geom_line(dat_misuse, aes(x= DEM_INCOME, y = misuse)) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "series2"))
dat_misuse <- dataca_totalmisuse %>% group_by(DEM_INCOME) %>% summarise(misuse = sum(has_misuse))
dat_misuse %>%
ggplot()+ geom_point(aes(x= DEM_INCOME, y = misuse))
dat_misuse %>%
ggplot()+ geom_line(aes(x= DEM_INCOME, y = misuse))
point
dat_misuse %>%
ggplot()+ geom_point(aes(x= DEM_INCOME, y = misuse))
dat_misuse %>%
ggplot()+ geom_line(aes(x= DEM_INCOME, y = misuse))
dat_misuse %>%
ggplot()+ geom_line(aes(x= DEM_INCOME, y = misuse), group = 1)
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "series2"))
dat_misuse %>%
ggplot()+ geom_line(aes(x= DEM_INCOME, y = misuse), group = 1)
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse, color = DEM_GENDER), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse, color = DEM_GENDER), size = 1.5,  group = 2) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity')  + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("#69b3a2", "#404080")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "#404080")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values+ "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue") + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="steelblue", alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue") + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), fill="steelblue", alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue") + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("hi") + ylab("hi")
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("Number of people in each income group vs. Number of people who has misused drugs") + ylab("Number of people in each income group by gender")
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("Number of people in each income group vs. \nNumber of people who has misused drugs") + ylab("Number of people in each income group by gender")
