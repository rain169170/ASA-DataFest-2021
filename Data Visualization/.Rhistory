ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "#404080")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values+ "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue") + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), color="steelblue", alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue") + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), fill="steelblue", alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue") + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("hi") + ylab("hi")
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("Number of people in each income group vs. Number of people who has misused drugs") + ylab("Number of people in each income group by gender")
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("Number of people in each income group vs. \nNumber of people who has misused drugs") + ylab("Number of people in each income group by gender")
knitr::opts_chunk$set(echo = TRUE)
library(dbplyr)
library(tidyverse)
library(readxl)
library(cowplot)
library(viridis)
library(gtsummary)
library(plotly)
library(gplots)
library(RColorBrewer)
library(heatmaply)
library(ggthemes)
library(ggridges)
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME), fill="steelblue", position = position_dodge(), alpha=0.6, position = 'identity') +scale_fill_manual(values= "steelblue") + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs"))
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER, position = position_dodge()), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("Number of people in each income group vs. \nNumber of people who has misused drugs") + ylab("Number of people in each income group by gender")
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), position = position_dodge(), color="#e9ecef", alpha=0.6, position = 'identity') +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("Number of people in each income group vs. \nNumber of people who has misused drugs") + ylab("Number of people in each income group by gender")
dataca_totalmisuse %>%
ggplot() + geom_bar(aes(x=DEM_INCOME, fill=DEM_GENDER), position = position_dodge(), alpha=0.6) +scale_fill_manual(values=c("chocolate2", "steelblue")) + geom_line(data = dat_misuse, aes(x= DEM_INCOME, y = misuse), size = 1.5,  group = 1) + theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(fill="") + scale_y_continuous(sec.axis = sec_axis(~./3, name = "Number of people who has misused drugs")) + ggtitle("Number of people in each income group vs. \nNumber of people who has misused drugs") + ylab("Number of people in each income group by gender")
#from statsCan, 2017
dataca <-dataca%>%
mutate(healthcare_pctg=case_when(DEM_LOCATION=="1" ~ 87,
DEM_LOCATION=="2" ~ 86.2,
DEM_LOCATION=="3" ~ 82.4,
DEM_LOCATION=="4" ~ 91.9,
DEM_LOCATION=="5" ~ 78.5,
DEM_LOCATION=="6" ~ 90.1,
DEM_LOCATION=="7" ~ 83.9,
DEM_LOCATION=="8" ~ 81.4,
DEM_LOCATION=="9" ~ 83.7,
DEM_LOCATION=="10" ~ 82,
DEM_LOCATION=="11" ~ 78.8,
DEM_LOCATION=="12" ~ 13.9,
DEM_LOCATION=="13" ~ 37.3))
library(tidyverse)
#Import Data
dataca <- read_csv("../Source Data/CA-Data/ca.csv")
datade <- read_csv("../Source Data/DE-Data/de.csv")
datauk <- read_csv("../Source Data/UK-Data/uk.csv")
dataus18 <- read_csv("../Source Data/US-Data/us_18Q1.csv")
dataus19 <- read_csv("../Source Data/US-Data/nmurx_us_19Q1.csv")
dataca_totalmisuse$total_misuse
table(dataca$DEM_GENDER)
# Label gender based on the given number in the source data
dataca$DEM_GENDER[dataca$DEM_GENDER == 1] <- "Male"
dataca$DEM_GENDER[dataca$DEM_GENDER == 2] <- "Female"
# Label location based on the survey
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 1] <- "NL"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 2] <- "NS"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 3] <- "PE"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 4] <- "NB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 5] <- "QC"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 6] <- "ON"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 7] <- "MB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 8] <- "SK"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 9] <- "AB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 10] <- "BC"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 11] <- "YT"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 12] <- "NU"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 13] <- "NT"
# Label region based on the survey
dataca$DEM_REGION[dataca$DEM_REGION == 1] <- "Altantic"
dataca$DEM_REGION[dataca$DEM_REGION == 2] <- "Quebec"
dataca$DEM_REGION[dataca$DEM_REGION == 3] <- "Ontario"
dataca$DEM_REGION[dataca$DEM_REGION == 4] <- "West"
# Label income based on the survey
dataca$DEM_INCOME[dataca$DEM_INCOME == 1] <- "<20,000"
dataca$DEM_INCOME[dataca$DEM_INCOME == 2] <- "20,000-39,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 3] <- "40,000-59,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 4] <- "60,000-79,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 5] <- "80,000-99,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 6] <- "100,000-119,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 7] <- "120,000-139,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 8] <- "140,000-159,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 9] <- ">160,000"
dataca$DEM_INCOME[dataca$DEM_INCOME == 10] <- "prefer not say"
# Label marital status based on the survey
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 1] <- "Married"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 2] <- "Living common-law"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 3] <- "Widowed"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 4] <- "Separated"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 5] <- "Divorced"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 6] <- "Never married"
# Label Pregnancy based on the survey
dataca$DEM_PREG[dataca$DEM_PREG == 1] <- "Pregnant"
dataca$DEM_PREG[dataca$DEM_PREG == 0] <- "Not pregnant"
# As.factor some variables
dataca$DEM_EDU <- as.factor(dataca$DEM_EDU)
#from statsCan, Dec2016
dataca <-dataca%>%
mutate(healthcpi=case_when(DEM_LOCATION=="1" ~ 114.7,
DEM_LOCATION=="2" ~ 116.8,
DEM_LOCATION=="3" ~ 116,
DEM_LOCATION=="4" ~ 113.8,
DEM_LOCATION=="5" ~ 123.6,
DEM_LOCATION=="6" ~ 126.6,
DEM_LOCATION=="7" ~ 118.1,
DEM_LOCATION=="8" ~ 119.2,
DEM_LOCATION=="9" ~ 142.6,
DEM_LOCATION=="10" ~ 119.8,
DEM_LOCATION=="11" ~ 125.2,
DEM_LOCATION=="12" ~ 125.2,
DEM_LOCATION=="13" ~ 117.6))
#from statsCan, 2017
dataca <-dataca%>%
mutate(csi=case_when(DEM_LOCATION=="1" ~ 63.51,
DEM_LOCATION=="2" ~ 66.26,
DEM_LOCATION=="3" ~ 45.86,
DEM_LOCATION=="4" ~ 68.74,
DEM_LOCATION=="5" ~ 57.82,
DEM_LOCATION=="6" ~ 56.34,
DEM_LOCATION=="7" ~ 119.01,
DEM_LOCATION=="8" ~ 143.1,
DEM_LOCATION=="9" ~ 112,
DEM_LOCATION=="10" ~ 87.23,
DEM_LOCATION=="11" ~ 183.56,
DEM_LOCATION=="12" ~ 300.43,
DEM_LOCATION=="13" ~ 309.36))
#from statsCan, 2017
dataca <-dataca%>%
mutate(healthcare_pctg=case_when(DEM_LOCATION=="1" ~ 87,
DEM_LOCATION=="2" ~ 86.2,
DEM_LOCATION=="3" ~ 82.4,
DEM_LOCATION=="4" ~ 91.9,
DEM_LOCATION=="5" ~ 78.5,
DEM_LOCATION=="6" ~ 90.1,
DEM_LOCATION=="7" ~ 83.9,
DEM_LOCATION=="8" ~ 81.4,
DEM_LOCATION=="9" ~ 83.7,
DEM_LOCATION=="10" ~ 82,
DEM_LOCATION=="11" ~ 78.8,
DEM_LOCATION=="12" ~ 13.9,
DEM_LOCATION=="13" ~ 37.3))
#Export cleaned data
write.csv(dataca, "./CA_Clean.csv")
dataca <- read_csv("../Data Cleaning/CA_Clean.csv")
dataca <- read_csv("../Data Cleaning/CA_Clean.csv")
dataca$healthcpi
#Import Data
dataca <- read_csv("../Source Data/CA-Data/ca.csv")
datade <- read_csv("../Source Data/DE-Data/de.csv")
datauk <- read_csv("../Source Data/UK-Data/uk.csv")
dataus18 <- read_csv("../Source Data/US-Data/us_18Q1.csv")
dataus19 <- read_csv("../Source Data/US-Data/nmurx_us_19Q1.csv")
#from statsCan, Dec2016
dataca <-dataca%>%
mutate(healthcpi=case_when(DEM_LOCATION=="1" ~ 114.7,
DEM_LOCATION=="2" ~ 116.8,
DEM_LOCATION=="3" ~ 116,
DEM_LOCATION=="4" ~ 113.8,
DEM_LOCATION=="5" ~ 123.6,
DEM_LOCATION=="6" ~ 126.6,
DEM_LOCATION=="7" ~ 118.1,
DEM_LOCATION=="8" ~ 119.2,
DEM_LOCATION=="9" ~ 142.6,
DEM_LOCATION=="10" ~ 119.8,
DEM_LOCATION=="11" ~ 125.2,
DEM_LOCATION=="12" ~ 125.2,
DEM_LOCATION=="13" ~ 117.6))
#from statsCan, 2017
dataca <-dataca%>%
mutate(csi=case_when(DEM_LOCATION=="1" ~ 63.51,
DEM_LOCATION=="2" ~ 66.26,
DEM_LOCATION=="3" ~ 45.86,
DEM_LOCATION=="4" ~ 68.74,
DEM_LOCATION=="5" ~ 57.82,
DEM_LOCATION=="6" ~ 56.34,
DEM_LOCATION=="7" ~ 119.01,
DEM_LOCATION=="8" ~ 143.1,
DEM_LOCATION=="9" ~ 112,
DEM_LOCATION=="10" ~ 87.23,
DEM_LOCATION=="11" ~ 183.56,
DEM_LOCATION=="12" ~ 300.43,
DEM_LOCATION=="13" ~ 309.36))
#from statsCan, 2017
dataca <-dataca%>%
mutate(healthcare_pctg=case_when(DEM_LOCATION=="1" ~ 87,
DEM_LOCATION=="2" ~ 86.2,
DEM_LOCATION=="3" ~ 82.4,
DEM_LOCATION=="4" ~ 91.9,
DEM_LOCATION=="5" ~ 78.5,
DEM_LOCATION=="6" ~ 90.1,
DEM_LOCATION=="7" ~ 83.9,
DEM_LOCATION=="8" ~ 81.4,
DEM_LOCATION=="9" ~ 83.7,
DEM_LOCATION=="10" ~ 82,
DEM_LOCATION=="11" ~ 78.8,
DEM_LOCATION=="12" ~ 13.9,
DEM_LOCATION=="13" ~ 37.3))
# Label gender based on the given number in the source data
dataca$DEM_GENDER[dataca$DEM_GENDER == 1] <- "Male"
dataca$DEM_GENDER[dataca$DEM_GENDER == 2] <- "Female"
# Label location based on the survey
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 1] <- "NL"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 2] <- "NS"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 3] <- "PE"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 4] <- "NB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 5] <- "QC"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 6] <- "ON"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 7] <- "MB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 8] <- "SK"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 9] <- "AB"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 10] <- "BC"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 11] <- "YT"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 12] <- "NU"
dataca$DEM_LOCATION[dataca$DEM_LOCATION == 13] <- "NT"
# Label region based on the survey
dataca$DEM_REGION[dataca$DEM_REGION == 1] <- "Altantic"
dataca$DEM_REGION[dataca$DEM_REGION == 2] <- "Quebec"
dataca$DEM_REGION[dataca$DEM_REGION == 3] <- "Ontario"
dataca$DEM_REGION[dataca$DEM_REGION == 4] <- "West"
# Label income based on the survey
dataca$DEM_INCOME[dataca$DEM_INCOME == 1] <- "<20,000"
dataca$DEM_INCOME[dataca$DEM_INCOME == 2] <- "20,000-39,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 3] <- "40,000-59,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 4] <- "60,000-79,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 5] <- "80,000-99,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 6] <- "100,000-119,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 7] <- "120,000-139,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 8] <- "140,000-159,999"
dataca$DEM_INCOME[dataca$DEM_INCOME == 9] <- ">160,000"
dataca$DEM_INCOME[dataca$DEM_INCOME == 10] <- "prefer not say"
# Label marital status based on the survey
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 1] <- "Married"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 2] <- "Living common-law"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 3] <- "Widowed"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 4] <- "Separated"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 5] <- "Divorced"
dataca$DEM_MARITAL[dataca$DEM_MARITAL == 6] <- "Never married"
# Label Pregnancy based on the survey
dataca$DEM_PREG[dataca$DEM_PREG == 1] <- "Pregnant"
dataca$DEM_PREG[dataca$DEM_PREG == 0] <- "Not pregnant"
# As.factor some variables
dataca$DEM_EDU <- as.factor(dataca$DEM_EDU)
#Export cleaned data
write.csv(dataca, "./CA_Clean.csv")
#write.csv(datade, "./DE_Clean.csv")
#write.csv(datauk, "./UK_Clean.csv")
#write.csv(dataus18, "./US18_Clean.csv")
#write.csv(dataus19, "./US19_Clean.csv")
dataca
dataca$healthcpi
dataca <- read_csv("../Data Cleaning/CA_Clean.csv")
datade <- read_csv("../Data Cleaning/DE_Clean.csv")
datauk <- read_csv("../Data Cleaning/UK_Clean.csv")
dataus18 <- read_csv("../Data Cleaning/US18_Clean.csv")
dataca_totalmisuse <- read_csv("../Data Cleaning/CA_total_misuse.csv")
attach(dataca)
dataca
dataca$healthcpi
dataca %>% group_by(DEM_LOCATION) %>% summarise(cpi = mean(healthcpi))
# Calculate total number of misused drugs for all 16 drugs for each participant
# Stored in variable total_misuse
dataca$FENT_NMU[is.na(dataca$FENT_NMU)] <- 0
dataca$BUP_NMU[is.na(dataca$BUP_NMU)] <- 0
dataca$METH_NMU[is.na(dataca$METH_NMU)] <- 0
dataca$MORPH_NMU[is.na(dataca$MORPH_NMU)] <- 0
dataca$OXY_NMU[is.na(dataca$OXY_NMU)] <- 0
dataca$OXYM_NMU[is.na(dataca$OXYM_NMU)] <- 0
dataca$TRAM_NMU[is.na(dataca$TRAM_NMU)] <- 0
dataca$TAP_NMU[is.na(dataca$TAP_NMU)] <- 0
dataca$COD_NMU[is.na(dataca$COD_NMU)] <- 0
dataca$COTC_NMU[is.na(dataca$COTC_NMU)] <- 0
dataca$HYD_NMU[is.na(dataca$HYD_NMU)] <- 0
dataca$HYDM_NMU[is.na(dataca$HYDM_NMU)] <- 0
dataca$SUF_NMU[is.na(dataca$SUF_NMU)] <- 0
dataca$STIM_NMU[is.na(dataca$STIM_NMU)] <- 0
dataca$BENZ_NMU[is.na(dataca$BENZ_NMU)] <- 0
dataca$THC_NMU[is.na(dataca$THC_NMU)] <- 0
dataca1 <- dataca %>%
mutate(total_misuse =FENT_NMU + BUP_NMU + METH_NMU + MORPH_NMU + OXY_NMU + OXYM_NMU + TRAM_NMU + TAP_NMU + COD_NMU + COTC_NMU + HYD_NMU + HYDM_NMU + SUF_NMU + STIM_NMU +  BENZ_NMU + THC_NMU)
dataca1 <- dataca1 %>% mutate(has_misuse = ifelse(total_misuse >= 1, 1, 0))
dataca1$has_misuse <- as.factor(dataca1$has_misuse)
write.csv(dataca1, "./CA_total_misuse.csv")
dataca <- read_csv("../Data Cleaning/CA_Clean.csv")
datade <- read_csv("../Data Cleaning/DE_Clean.csv")
datauk <- read_csv("../Data Cleaning/UK_Clean.csv")
dataus18 <- read_csv("../Data Cleaning/US18_Clean.csv")
dataca_totalmisuse <- read_csv("../Data Cleaning/CA_total_misuse.csv")
attach(dataca)
dataca
dataca %>% group_by(DEM_LOCATION) %>% summarise(cpi = mean(healthcpi), hi = n())
dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(cpi = mean(healthcpi), prop_misuse = sum(has_misuse)/n())
dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(cpi = mean(healthcpi), prop_misuse = sum(has_misuse))
/n()
ggplot(dataca, aes(Years, ppb, shape=Gas, colour=Gas, fill=Gas)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("Years") +
ylab("Concentrations (ppb)") +
ggtitle("Banizoumbou") +
expand_limits(y=0) +
scale_y_continuous(breaks = 0:10) +
scale_x_continuous(breaks = 1998:2015)
dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(cpi = mean(healthcpi), prop_misuse = sum(has_misuse)/n())
ggplot(datacpi, aes(cpi, prop_misuse, colour=DEM_LOCATION, fill=DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("Years") +
ylab("Concentrations (ppb)") +
ggtitle("Banizoumbou") +
expand_limits(y=0) +
scale_y_continuous(breaks = 0:10) +
scale_x_continuous(breaks = 1998:2015)
ggplot(datcpi, aes(cpi, prop_misuse, colour=DEM_LOCATION, fill=DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("Years") +
ylab("Concentrations (ppb)") +
ggtitle("Banizoumbou") +
expand_limits(y=0) +
scale_y_continuous(breaks = 0:10) +
scale_x_continuous(breaks = 1998:2015)
datcpi <- dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(cpi = mean(healthcpi), prop_misuse = sum(has_misuse)/n())
ggplot(datcpi, aes(cpi, prop_misuse, colour=DEM_LOCATION, fill=DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("Years") +
ylab("Concentrations (ppb)") +
ggtitle("Banizoumbou") +
expand_limits(y=0) +
scale_y_continuous(breaks = 0:10) +
scale_x_continuous(breaks = 1998:2015)
datcpi
ggplot(datcpi, aes(cpi, prop_misuse, colour=DEM_LOCATION, fill=DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("cpi") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. CPI") +
expand_limits(y=0) +
scale_y_continuous(breaks = 0:10) +
scale_x_continuous(breaks = 1998:2015)
ggplot(datcpi, aes(cpi, prop_misuse) +
ggplot(datcpi, aes(cpi, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("cpi") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. CPI") +
expand_limits(y=0) +
scale_y_continuous(breaks = 0:10) +
scale_x_continuous(breaks = 1998:2015)
ggplot(datcpi, aes(cpi, prop_misuse)) +
ggplot(datcpi, aes(cpi, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("cpi") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. CPI") +
expand_limits(y=0)
ggplot(datcsi, aes(csi, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("csi") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. CSI") +
expand_limits(y=0)
datcsi <- dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(csi = mean(csi), prop_misuse = sum(has_misuse)/n())
ggplot(datcsi, aes(csi, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("csi") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. CSI") +
expand_limits(y=0)
ggplot(datcsi, aes(csi, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("csi") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. CSI")
csi
```{r}
dathealthcare_pctg <- dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(healthcare_pctg = mean(healthcare_pctg), prop_misuse = sum(has_misuse)/n())
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. healthcare_pctg")
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse, color = DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. healthcare_pctg")
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse, color = DEM_LOCATION), group = 1) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. healthcare_pctg")
dathealthcare_pctg <- dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(healthcare_pctg = mean(healthcare_pctg), prop_misuse = sum(has_misuse)/n())
dathealthcare_pctg
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse, color = DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. healthcare_pctg")
dathealthcare_pctg <- dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(healthcare_pctg = mean(healthcare_pctg), prop_misuse = sum(has_misuse)/n()) %>% filter(healthcare_pctg > 0.01)
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse, color = DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. healthcare_pctg")
dathealthcare_pctg
dathealthcare_pctg <- dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(healthcare_pctg = mean(healthcare_pctg), prop_misuse = sum(has_misuse)/n()) %>% filter(prop_misuse > 0.01)
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse, color = DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. healthcare_pctg")
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse) +
geom_point(size=3) +
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. healthcare_pctg")
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse)) +
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs healthcare_pctg")
datcsi <- dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(csi = mean(csi), prop_misuse = sum(has_misuse)/n()) %>% filter(prop_misuse > 0.01)
ggplot(datcsi, aes(csi, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("csi") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. ")
datcpi <- dataca_totalmisuse %>% group_by(DEM_LOCATION) %>% summarise(cpi = mean(healthcpi), prop_misuse = sum(has_misuse)/n()) %>% filter(prop_misuse > 0.01)
ggplot(datcpi, aes(cpi, prop_misuse)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("cpi") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs. CPI") +
expand_limits(y=0)
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse, fill = DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs healthcare_pctg")
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse, color = DEM_LOCATION)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs healthcare_pctg")
ggplot(dathealthcare_pctg, aes(healthcare_pctg, prop_misuse, color = DEM_LOCATION, group = 1)) +
geom_smooth(method="lm") +
geom_point(size=3) +
theme_bw() +
xlab("healthcare_pctg") +
ylab("proportion of people who have misused drugs") +
ggtitle("Proportion of people who have misused drugs vs healthcare_pctg")
